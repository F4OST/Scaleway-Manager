<ion-header no-border>
  <ion-navbar>
    <button ion-button menuToggle>
      <ion-icon name="menu"></ion-icon>
    </button>
    <ion-title>
      <div class="logo-text">
        <div class="logo-title">Servers</div>
      </div>
    </ion-title>
  </ion-navbar>
</ion-header>


<ion-content>

  <ion-refresher (ionRefresh)="doRefresh($event)">
    <ion-refresher-content></ion-refresher-content>
  </ion-refresher>

  <loader *ngIf="isLoading"></loader>

  <div *ngIf="!isLoading">
    <ion-list *ngIf="serverParis.servers !== undefined && serverParis.servers.length !== 0">
      <ion-list-header>
        <img class="country-flag" src="assets/imgs/france.svg"><span style="vertical-align: middle">Paris</span>
        <span class="header-right">{{ serverParis.servers.length }}
          server{{ serverParis.servers.length > 1 ? 's' : ''}}</span>
      </ion-list-header>

      <ion-item-sliding *ngFor="let server of serverParis.servers" #item>
        <ion-item (click)="showServer(server, serverParis.country)">
          <ion-avatar item-start>
            <img class="img-os"
                 src="{{ server.image ? (server.image.name | serverIcon) : (server.name | serverIcon) }}">
          </ion-avatar>
          <div [class]='setClass(server)' [style.background]="setState(server)"></div>
          <h2>{{ server.name }}</h2>
          <p>{{ server.commercial_type }}</p>
          <ion-note item-end>
            <ion-icon name="arrow-forward"></ion-icon>
          </ion-note>
        </ion-item>

        <ion-item-options *ngIf="server.state === 'running'">
          <button ion-button color="danger" (click)="serverAction(server, 'poweroff', item, serverParis.country)">
            OFF
          </button>
        </ion-item-options>
        <ion-item-options *ngIf="server.state === 'stopped'">
          <button ion-button color="secondary" (click)="serverAction(server, 'poweron', item, serverParis.country)">
            ON
          </button>
        </ion-item-options>
      </ion-item-sliding>
    </ion-list>

    <ion-list *ngIf="serverNetherlands.servers !== undefined && serverNetherlands.servers.length !== 0">
      <ion-list-header>
        <img class="country-flag" src="assets/imgs/netherlands.svg"><span
        style="vertical-align: middle">Amsterdam</span>
        <span class="header-right">{{ serverNetherlands.servers.length }}
          server{{ serverParis.servers.length > 1 ? 's' : ''}}</span>
      </ion-list-header>

      <ion-item-sliding *ngFor="let server of serverNetherlands.servers" #item>
        <ion-item (click)="showServer(server, serverNetherlands.country)">
          <ion-avatar item-start>
            <img class="img-os"
                 src="{{ server.image ? (server.image.name | serverIcon) : (server.name | serverIcon) }}">
          </ion-avatar>
          <div [class]='setClass(server)' [style.background]="setState(server)"></div>
          <h2>{{ server.name }}</h2>
          <p>{{ server.commercial_type }}</p>
          <ion-note item-end>
            <ion-icon name="arrow-forward"></ion-icon>
          </ion-note>
        </ion-item>

        <ion-item-options *ngIf="server.state === 'running'">
          <button ion-button color="danger" (click)="serverAction(server, 'poweroff', item, serverNetherlands.country)">
            OFF
          </button>
        </ion-item-options>
        <ion-item-options *ngIf="server.state === 'stopped'">
          <button ion-button color="secondary"
                  (click)="serverAction(server, 'poweron', item, serverNetherlands.country)">
            ON
          </button>
        </ion-item-options>
      </ion-item-sliding>
    </ion-list>
    <p class="no-server" margin-top text-center
       *ngIf="!isLoading && serverParis.servers.length === 0 && serverNetherlands.servers.length === 0"
       text-center>
      <img src="assets/imgs/server.svg">
      No server available
    </p>
  </div>
</ion-content>
